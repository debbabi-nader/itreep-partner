window.paceOptions={document:!0,eventLag:!0,restartOnPushState:!0,restartOnRequestAfter:!0,ajax:{trackMethods:["GET","PUT","PATCH","POST","DELETE"]}},(function(){var t,e,n,i,o,r,s,a,l,u,h,c,p,d,f,m,g,v,w,y,b,x,C,E,L,R,k,S,_,M,P,O,T,j,A,q,B,F,N,z,X,Z,I,W,Y,H,D,U,G=[].slice,K={}.hasOwnProperty,$=function(t,e){function n(){this.constructor=t}for(var i in e)K.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},J=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};for(b={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},_=function(){var t;return null!=(t="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?t:+new Date},P=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,y=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==P&&(P=function(t){return setTimeout(t,50)},y=function(t){return clearTimeout(t)}),T=function(t){var e,n;return e=_(),(n=function(){var i;return(i=_()-e)>=33?(e=_(),t(i,function(){return P(n)})):setTimeout(n,33-i)})()},O=function(){var t,e,n;return n=arguments[0],e=arguments[1],t=3<=arguments.length?G.call(arguments,2):[],"function"==typeof n[e]?n[e].apply(n,t):n[e]},x=function(){var t,e,n,i,o,r,s;for(e=arguments[0],r=0,s=(i=2<=arguments.length?G.call(arguments,1):[]).length;s>r;r++)if(n=i[r])for(t in n)K.call(n,t)&&(o=n[t],null!=e[t]&&"object"==typeof e[t]&&null!=o&&"object"==typeof o?x(e[t],o):e[t]=o);return e},g=function(t){var e,n,i,o;for(n=e=0,i=0,o=t.length;o>i;i++)n+=Math.abs(t[i]),e++;return n/e},E=function(t,e){var n,i;if(null==t&&(t="options"),null==e&&(e=!0),i=document.querySelector("[data-pace-"+t+"]")){if(n=i.getAttribute("data-pace-"+t),!e)return n;try{return JSON.parse(n)}catch(r){return"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",r):void 0}}},s=function(){function t(){}return t.prototype.on=function(t,e,n,i){var o;return null==i&&(i=!1),null==this.bindings&&(this.bindings={}),null==(o=this.bindings)[t]&&(o[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:i})},t.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},t.prototype.off=function(t,e){var n,i,o;if(null!=(null!=(i=this.bindings)?i[t]:void 0)){if(null==e)return delete this.bindings[t];for(n=0,o=[];n<this.bindings[t].length;)o.push(this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):n++);return o}},t.prototype.trigger=function(){var t,e,n,i,o,r,s,a;if(n=arguments[0],t=2<=arguments.length?G.call(arguments,1):[],null!=(r=this.bindings)?r[n]:void 0){for(i=0,a=[];i<this.bindings[n].length;)o=(s=this.bindings[n][i]).once,s.handler.apply(null!=(e=s.ctx)?e:this,t),a.push(o?this.bindings[n].splice(i,1):i++);return a}},t}(),u=window.Pace||{},window.Pace=u,x(u,s.prototype),M=u.options=x({},b,window.paceOptions,E()),I=0,Y=(D=["ajax","document","eventLag","elements"]).length;Y>I;I++)!0===M[B=D[I]]&&(M[B]=b[B]);l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return $(e,t),e}(Error),e=function(){function t(){this.progress=0}return t.prototype.getElement=function(){var t;if(null==this.el){if(!(t=document.querySelector(M.target)))throw new l;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/pace-done/g,""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=t.firstChild?t.insertBefore(this.el,t.firstChild):t.appendChild(this.el)}return this.el},t.prototype.finish=function(){var t;return(t=this.getElement()).className=t.className.replace("pace-active",""),t.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},t.prototype.update=function(t){return this.progress=t,this.render()},t.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(t){l=t}return this.el=void 0},t.prototype.render=function(){var t,e,n,i,o,r;if(null==document.querySelector(M.target))return!1;for(t=this.getElement(),n="translate3d("+this.progress+"%, 0, 0)",i=0,o=(r=["webkitTransform","msTransform","transform"]).length;o>i;i++)t.children[0].style[r[i]]=n;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(t.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),this.progress>=100?e="99":(e=this.progress<10?"0":"",e+=0|this.progress),t.children[0].setAttribute("data-progress",""+e)),this.lastRenderedProgress=this.progress},t.prototype.done=function(){return this.progress>=100},t}(),a=function(){function t(){this.bindings={}}return t.prototype.trigger=function(t,e){var n,i,o,r;if(null!=this.bindings[t]){for(r=[],n=0,i=(o=this.bindings[t]).length;i>n;n++)r.push(o[n].call(this,e));return r}},t.prototype.on=function(t,e){var n;return null==(n=this.bindings)[t]&&(n[t]=[]),this.bindings[t].push(e)},t}(),Z=window.XMLHttpRequest,X=window.XDomainRequest,z=window.WebSocket,C=function(t,e){var n,i;for(n in i=[],e.prototype)try{null==t[n]&&"function"!=typeof e[n]?"function"==typeof Object.defineProperty?i.push(Object.defineProperty(t,n,{get:function(){return e.prototype[n]},configurable:!0,enumerable:!0})):i.push(t[n]=e.prototype[n]):i.push(void 0)}catch(r){}return i},k=[],u.ignore=function(){var t,e,n;return e=arguments[0],t=2<=arguments.length?G.call(arguments,1):[],k.unshift("ignore"),n=e.apply(null,t),k.shift(),n},u.track=function(){var t,e,n;return e=arguments[0],t=2<=arguments.length?G.call(arguments,1):[],k.unshift("track"),n=e.apply(null,t),k.shift(),n},q=function(t){var e;if(null==t&&(t="GET"),"track"===k[0])return"force";if(!k.length&&M.ajax){if("socket"===t&&M.ajax.trackWebSockets)return!0;if(e=t.toUpperCase(),J.call(M.ajax.trackMethods,e)>=0)return!0}return!1},h=function(t){function e(){var t,n=this;e.__super__.constructor.apply(this,arguments),t=function(t){var e;return e=t.open,t.open=function(i,o,r){return q(i)&&n.trigger("request",{type:i,url:o,request:t}),e.apply(t,arguments)}},window.XMLHttpRequest=function(e){var n;return n=new Z(e),t(n),n};try{C(window.XMLHttpRequest,Z)}catch(i){}if(null!=X){window.XDomainRequest=function(){var e;return e=new X,t(e),e};try{C(window.XDomainRequest,X)}catch(i){}}if(null!=z&&M.ajax.trackWebSockets){window.WebSocket=function(t,e){var i;return i=null!=e?new z(t,e):new z(t),q("socket")&&n.trigger("request",{type:"socket",url:t,protocols:e,request:i}),i};try{C(window.WebSocket,z)}catch(i){}}}return $(e,a),e}(),W=null,A=function(t){var e,n,i,o;for(n=0,i=(o=M.ajax.ignoreURLs).length;i>n;n++)if("string"==typeof(e=o[n])){if(-1!==t.indexOf(e))return!0}else if(e.test(t))return!0;return!1},(L=function(){return null==W&&(W=new h),W})().on("request",function(e){var n,i,o,r;return r=e.type,o=e.request,A(e.url)?void 0:u.running||!1===M.restartOnRequestAfter&&"force"!==q(r)?void 0:(i=arguments,"boolean"==typeof(n=M.restartOnRequestAfter||0)&&(n=0),setTimeout(function(){var e,n,s,a,l;if("socket"===r?o.readyState<2:0<(s=o.readyState)&&4>s){for(u.restart(),l=[],e=0,n=(a=u.sources).length;n>e;e++){if((B=a[e])instanceof t){B.watch.apply(B,i);break}l.push(void 0)}return l}},n))}),t=function(){function t(){var t=this;this.elements=[],L().on("request",function(){return t.watch.apply(t,arguments)})}return t.prototype.watch=function(t){var e,n,i;return i=t.type,e=t.request,A(t.url)?void 0:(n="socket"===i?new d(e):new f(e),this.elements.push(n))},t}(),f=function(t){var e,n,i,o,r=this;if(this.progress=0,null!=window.ProgressEvent)for(t.addEventListener("progress",function(t){return r.progress=t.lengthComputable?100*t.loaded/t.total:r.progress+(100-r.progress)/2},!1),e=0,n=(o=["load","abort","timeout","error"]).length;n>e;e++)t.addEventListener(o[e],function(){return r.progress=100},!1);else i=t.onreadystatechange,t.onreadystatechange=function(){var e;return 0===(e=t.readyState)||4===e?r.progress=100:3===t.readyState&&(r.progress=50),"function"==typeof i?i.apply(null,arguments):void 0}},d=function(t){var e,n,i,o=this;for(this.progress=0,e=0,n=(i=["error","open"]).length;n>e;e++)t.addEventListener(i[e],function(){return o.progress=100},!1)},i=function(t){var e,n,i;for(null==t&&(t={}),this.elements=[],null==t.selectors&&(t.selectors=[]),e=0,n=(i=t.selectors).length;n>e;e++)this.elements.push(new o(i[e]))},o=function(){function t(t){this.selector=t,this.progress=0,this.check()}return t.prototype.check=function(){var t=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return t.check()},M.elements.checkInterval)},t.prototype.done=function(){return this.progress=100},t}(),n=function(){function t(){var t,e,n=this;this.progress=null!=(e=this.states[document.readyState])?e:100,t=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof t?t.apply(null,arguments):void 0}}return t.prototype.states={loading:0,interactive:50,complete:100},t}(),r=function(){var t,e,n,i,o,r=this;this.progress=0,t=0,o=[],i=0,n=_(),e=setInterval(function(){var s;return s=_()-n-50,n=_(),o.push(s),o.length>M.eventLag.sampleCount&&o.shift(),t=g(o),++i>=M.eventLag.minSamples&&t<M.eventLag.lagThreshold?(r.progress=100,clearInterval(e)):r.progress=3/(t+3)*100},50)},p=function(){function t(t){this.source=t,this.last=this.sinceLastUpdate=0,this.rate=M.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=O(this.source,"progress"))}return t.prototype.tick=function(t,e){var n;return null==e&&(e=O(this.source,"progress")),e>=100&&(this.done=!0),e===this.last?this.sinceLastUpdate+=t:(this.sinceLastUpdate&&(this.rate=(e-this.last)/this.sinceLastUpdate),this.catchup=(e-this.progress)/M.catchupTime,this.sinceLastUpdate=0,this.last=e),e>this.progress&&(this.progress+=this.catchup*t),n=1-Math.pow(this.progress/100,M.easeFactor),this.progress+=n*this.rate*t,this.progress=Math.min(this.lastProgress+M.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},t}(),F=null,j=null,v=null,N=null,m=null,w=null,u.running=!1,R=function(){return M.restartOnPushState?u.restart():void 0},null!=window.history.pushState&&(H=window.history.pushState,window.history.pushState=function(){return R(),H.apply(window.history,arguments)}),null!=window.history.replaceState&&(U=window.history.replaceState,window.history.replaceState=function(){return R(),U.apply(window.history,arguments)}),c={ajax:t,elements:i,document:n,eventLag:r},(S=function(){var t,n,i,o,r,s,a,l;for(u.sources=F=[],n=0,o=(s=["ajax","elements","document","eventLag"]).length;o>n;n++)!1!==M[t=s[n]]&&F.push(new c[t](M[t]));for(i=0,r=(l=null!=(a=M.extraSources)?a:[]).length;r>i;i++)F.push(new(B=l[i])(M));return u.bar=v=new e,j=[],N=new p})(),u.stop=function(){return u.trigger("stop"),u.running=!1,v.destroy(),w=!0,null!=m&&("function"==typeof y&&y(m),m=null),S()},u.restart=function(){return u.trigger("restart"),u.stop(),u.start()},u.go=function(){var t;return u.running=!0,v.render(),t=_(),w=!1,m=T(function(e,n){var i,o,r,s,a,l,h,c,d,f,m,g,y;for(i=c=0,o=!0,s=d=0,m=F.length;m>d;s=++d)for(B=F[s],h=null!=j[s]?j[s]:j[s]=[],a=f=0,g=(r=null!=(y=B.elements)?y:[B]).length;g>f;a=++f)o&=(l=null!=h[a]?h[a]:h[a]=new p(r[a])).done,l.done||(i++,c+=l.tick(e));return v.update(N.tick(e,c/i)),v.done()||o||w?(v.update(100),u.trigger("done"),setTimeout(function(){return v.finish(),u.running=!1,u.trigger("hide")},Math.max(M.ghostTime,Math.max(M.minTime-(_()-t),0)))):n()})},u.start=function(t){x(M,t),u.running=!0;try{v.render()}catch(e){l=e}return document.querySelector(".pace")?(u.trigger("start"),u.go()):setTimeout(u.start,50)},"function"==typeof define&&define.amd?define(["pace"],function(){return u}):"object"==typeof exports?module.exports=u:M.startOnPageLoad&&u.start()}).call(this),function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):"object"==typeof exports&&"string"!=typeof exports.nodeName?e(exports):e(t.commonJsStrict={})}(this,function(t){"function"!=typeof Promise&&function(t){function e(t,e){return function(){t.apply(e,arguments)}}function n(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(t,e(o,this),e(r,this))}function i(t){var e=this;return null===this._state?void this._deferreds.push(t):void h(function(){var n=e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(o){return void t.reject(o)}t.resolve(i)}else(e._state?t.resolve:t.reject)(e._value)})}function o(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void l(e(n,t),e(o,this),e(r,this))}this._state=!0,this._value=t,s.call(this)}catch(i){r.call(this,i)}}function r(t){this._state=!1,this._value=t,s.call(this)}function s(){for(var t=0,e=this._deferreds.length;e>t;t++)i.call(this,this._deferreds[t]);this._deferreds=null}function a(t,e,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=i}function l(t,e,n){var i=!1;try{t(function(t){i||(i=!0,e(t))},function(t){i||(i=!0,n(t))})}catch(o){if(i)return;i=!0,n(o)}}var u=setTimeout,h="function"==typeof setImmediate&&setImmediate||function(t){u(t,1)},c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){var o=this;return new n(function(n,r){i.call(o,new a(t,e,n,r))})},n.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&c(arguments[0])?arguments[0]:arguments);return new n(function(e,n){function i(r,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){i(r,t)},n)}t[r]=s,0==--o&&e(t)}catch(l){n(l)}}if(0===t.length)return e([]);for(var o=t.length,r=0;r<t.length;r++)i(r,t[r])})},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n(function(e){e(t)})},n.reject=function(t){return new n(function(e,n){n(t)})},n.race=function(t){return new n(function(e,n){for(var i=0,o=t.length;o>i;i++)t[i].then(e,n)})},n._setImmediateFn=function(t){h=t},"undefined"!=typeof module&&module.exports?module.exports=n:t.Promise||(t.Promise=n)}(this),"function"!=typeof window.CustomEvent&&function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),o=i.length,r=new Uint8Array(o),s=0;s<o;s++)r[s]=i.charCodeAt(s);t(new Blob([r],{type:e||"image/png"}))}});var e,n,i,o=["Webkit","Moz","ms"],r=document.createElement("div").style,s=[1,8,3,6],a=[2,7,4,5];function l(t){if(t in r)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=o.length;n--;)if((t=o[n]+e)in r)return t}function u(t,e){for(var n in t=t||{},e)e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},u(t[n],e[n])):t[n]=e[n];return t}function h(t){return u({},t)}function c(t){if("createEvent"in document){var e=document.createEvent("HTMLEvents");e.initEvent("change",!1,!0),t.dispatchEvent(e)}else t.fireEvent("onchange")}function p(t,e,n){if("string"==typeof e){var i=e;(e={})[i]=n}for(var o in e)t.style[o]=e[o]}function d(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function f(t,e){for(var n in e)t.setAttribute(n,e[n])}function m(t){return parseInt(t,10)}function g(t,e){var n=t.naturalWidth,i=t.naturalHeight,o=e||b(t);if(o&&o>=5){var r=n;n=i,i=r}return{width:n,height:i}}n=l("transform"),e=l("transformOrigin"),i=l("userSelect");var v={translate3d:{suffix:", 0px"},translate:{suffix:""}},w=function(t,e,n){this.x=parseFloat(t),this.y=parseFloat(e),this.scale=parseFloat(n)};w.parse=function(t){return t.style?w.parse(t.style[n]):t.indexOf("matrix")>-1||t.indexOf("none")>-1?w.fromMatrix(t):w.fromString(t)},w.fromMatrix=function(t){var e=t.substring(7).split(",");return e.length&&"none"!==t||(e=[1,0,0,1,0,0]),new w(m(e[4]),m(e[5]),parseFloat(e[0]))},w.fromString=function(t){var e=t.split(") "),n=e[0].substring(Z.globals.translate.length+1).split(","),i=e.length>1?e[1].substring(6):1;return new w(n.length>1?n[0]:0,n.length>1?n[1]:0,i)},w.prototype.toString=function(){return Z.globals.translate+"("+this.x+"px, "+this.y+"px"+(v[Z.globals.translate].suffix||"")+") scale("+this.scale+")"};var y=function(t){if(!t||!t.style[e])return this.x=0,void(this.y=0);var n=t.style[e].split(" ");this.x=parseFloat(n[0]),this.y=parseFloat(n[1])};function b(t){return t.exifdata?t.exifdata.Orientation:1}function x(t,e,n){var i=e.width,o=e.height,r=t.getContext("2d");switch(t.width=e.width,t.height=e.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:t.width=o,t.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:t.width=o,t.height=i,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:t.width=o,t.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,o),r.scale(1,-1);break;case 8:t.width=o,t.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(e,0,0,i,o),r.restore()}function C(){return this.options.enableExif&&window.EXIF}function E(t){if(this.options.enableZoom){var e=this.elements.zoomer,n=B(t,4);e.value=Math.max(e.min,Math.min(e.max,n))}}function L(t){var i=this,o=t?t.transform:w.parse(i.elements.preview),r=t?t.viewportRect:i.elements.viewport.getBoundingClientRect(),s=t?t.origin:new y(i.elements.preview);function a(){var t={};t[n]=o.toString(),t[e]=s.toString(),p(i.elements.preview,t)}if(i._currentZoom=t?t.value:i._currentZoom,o.scale=i._currentZoom,i.elements.zoomer.setAttribute("aria-valuenow",i._currentZoom),a(),i.options.enforceBoundary){var l=(function(t){var e=this._currentZoom,n=t.width,i=t.height,o=this.elements.boundary.clientWidth/2,r=this.elements.boundary.clientHeight/2,s=this.elements.preview.getBoundingClientRect(),a=s.width,l=s.height,u=n/2,h=i/2,c=-1*(u/e-o),p=-1*(h/e-r),d=1/e*u,f=1/e*h;return{translate:{maxX:c,minX:c-(a*(1/e)-n*(1/e)),maxY:p,minY:p-(l*(1/e)-i*(1/e))},origin:{maxX:a*(1/e)-d,minX:d,maxY:l*(1/e)-f,minY:f}}}).call(i,r),u=l.translate,h=l.origin;o.x>=u.maxX&&(s.x=h.minX,o.x=u.maxX),o.x<=u.minX&&(s.x=h.maxX,o.x=u.minX),o.y>=u.maxY&&(s.y=h.minY,o.y=u.maxY),o.y<=u.minY&&(s.y=h.maxY,o.y=u.minY)}a(),M.call(i),P.call(i)}function R(){var t=this._currentZoom,i=this.elements.preview.getBoundingClientRect(),o=this.elements.viewport.getBoundingClientRect(),r=w.parse(this.elements.preview.style[n]),s=new y(this.elements.preview),a=o.left-i.left+o.width/2,l={},u={};l.y=(o.top-i.top+o.height/2)/t,l.x=a/t,u.y=(l.y-s.y)*(1-t),u.x=(l.x-s.x)*(1-t),r.x-=u.x,r.y-=u.y;var h={};h[e]=l.x+"px "+l.y+"px",h[n]=r.toString(),p(this.elements.preview,h)}function k(){if(this.elements){var t=this.elements.boundary.getBoundingClientRect(),e=this.elements.preview.getBoundingClientRect();p(this.elements.overlay,{width:e.width+"px",height:e.height+"px",top:e.top-t.top+"px",left:e.left-t.left+"px"})}}y.prototype.toString=function(){return this.x+"px "+this.y+"px"};var S,_,M=(S=k,function(){var t=this,e=arguments;clearTimeout(_),_=setTimeout(function(){_=null,S.apply(t,e)},500)});function P(){var t,e=this.get();O.call(this)&&(this.options.update.call(this,e),this.$&&"undefined"==typeof Prototype?this.$(this.element).trigger("update.croppie",e):(window.CustomEvent?t=new CustomEvent("update",{detail:e}):(t=document.createEvent("CustomEvent")).initCustomEvent("update",!0,!0,e),this.element.dispatchEvent(t)))}function O(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function T(){var t,i={},o=this.elements.preview,r=new w(0,0,1),s=new y;O.call(this)&&!this.data.bound&&(this.data.bound=!0,i[n]=r.toString(),i[e]=s.toString(),i.opacity=1,p(o,i),t=this.elements.preview.getBoundingClientRect(),this._originalImageWidth=t.width,this._originalImageHeight=t.height,this.data.orientation=b(this.elements.img),this.options.enableZoom?j.call(this,!0):this._currentZoom=1,r.scale=this._currentZoom,i[n]=r.toString(),p(o,i),this.data.points.length?(function(t){if(4!==t.length)throw"Croppie - Invalid number of points supplied: "+t;var i=t[2]-t[0],o=this.elements.viewport.getBoundingClientRect(),r=this.elements.boundary.getBoundingClientRect(),s=o.width/i,a=-1*t[1]+(o.top-r.top),l=-1*t[0]+(o.left-r.left),u={};u[e]=t[0]+"px "+t[1]+"px",u[n]=new w(l,a,s).toString(),p(this.elements.preview,u),E.call(this,s),this._currentZoom=s}).call(this,this.data.points):(function(){var t=this.elements.preview.getBoundingClientRect(),e=this.elements.viewport.getBoundingClientRect(),i=this.elements.boundary.getBoundingClientRect(),o=new w(e.left-i.left-(t.width-e.width)/2,e.top-i.top-(t.height-e.height)/2,this._currentZoom);p(this.elements.preview,n,o.toString())}).call(this),R.call(this),k.call(this))}function j(t){var e,n=0,i=this.options.maxZoom||1.5,o=this.elements.zoomer,r=parseFloat(o.value),s=this.elements.boundary.getBoundingClientRect(),a=g(this.elements.img,this.data.orientation),l=this.elements.viewport.getBoundingClientRect();this.options.enforceBoundary&&(n=Math.max(l.width/a.width,l.height/a.height)),n>=i&&(i=n+1),o.min=B(n,4),o.max=B(i,4),!t&&(r<o.min||r>o.max)?E.call(this,r<o.min?o.min:o.max):t&&(e=Math.max(s.width/a.width,s.height/a.height),E.call(this,null!==this.data.boundZoom?this.data.boundZoom:e)),c(o)}function A(t){var e=t.points,n=m(e[0]),i=m(e[1]),o=m(e[2])-n,r=m(e[3])-i,s=t.circle,a=document.createElement("canvas"),l=a.getContext("2d"),u=t.outputWidth||o,h=t.outputHeight||r;return a.width=u,a.height=h,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,u,h)),!1!==this.options.enforceBoundary&&(o=Math.min(o,this._originalImageWidth),r=Math.min(r,this._originalImageHeight)),l.drawImage(this.elements.preview,n,i,o,r,0,0,u,h),s&&(l.fillStyle="#fff",l.globalCompositeOperation="destination-in",l.beginPath(),l.arc(a.width/2,a.height/2,a.width/2,0,2*Math.PI,!0),l.closePath(),l.fill()),a}function q(t,e){var n,i,o,r,s=this,a=[],l=null,u=C.call(s);if("string"==typeof t)n=t,t={};else if(Array.isArray(t))a=t.slice();else{if(void 0===t&&s.data.url)return T.call(s),P.call(s),null;n=t.url,a=t.points||[],l=void 0===t.zoom?null:t.zoom}return s.data.bound=!1,s.data.url=n||s.data.url,s.data.boundZoom=l,(i=n,o=u,r=new Image,r.style.opacity=0,new Promise(function(t){function e(){r.style.opacity=1,setTimeout(function(){t(r)},1)}r.removeAttribute("crossOrigin"),i.match(/^https?:\/\/|^\/\//)&&r.setAttribute("crossOrigin","anonymous"),r.onload=function(){o?EXIF.getData(r,function(){e()}):e()},r.src=i})).then(function(n){if((function(t){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(e){t.classList.add(e)}),this.elements.img.parentNode.replaceChild(t,this.elements.img),this.elements.preview=t),this.elements.img=t}).call(s,n),a.length)s.options.relative&&(a=[a[0]*n.naturalWidth/100,a[1]*n.naturalHeight/100,a[2]*n.naturalWidth/100,a[3]*n.naturalHeight/100]);else{var i,o,r=g(n),l=s.elements.viewport.getBoundingClientRect(),u=l.width/l.height;r.width/r.height>u?i=(o=r.height)*u:(i=r.width,o=r.height/u);var h=(r.width-i)/2,c=(r.height-o)/2;s.data.points=[h,c,h+i,c+o]}s.data.points=a.map(function(t){return parseFloat(t)}),s.options.useCanvas&&(function(t){var e=this.elements.canvas,n=this.elements.img,i=e.getContext("2d"),o=C.call(this);t=this.options.enableOrientation&&t,i.clearRect(0,0,e.width,e.height),e.width=n.width,e.height=n.height,o&&!t?x(e,n,m(b(n)||0)):t&&x(e,n,t)}).call(s,t.orientation||1),T.call(s),P.call(s),e&&e()}).catch(function(t){console.error("Croppie:"+t)})}function B(t,e){return parseFloat(t).toFixed(e||0)}function F(){var t=this.elements.preview.getBoundingClientRect(),e=this.elements.viewport.getBoundingClientRect(),n=e.left-t.left,i=e.top-t.top,o=n+this.elements.viewport.offsetWidth+(e.width-this.elements.viewport.offsetWidth)/2,r=i+this.elements.viewport.offsetHeight+(e.height-this.elements.viewport.offsetHeight)/2,s=this._currentZoom;(s===1/0||isNaN(s))&&(s=1);var a=this.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return n=Math.max(a,n/s),i=Math.max(a,i/s),o=Math.max(a,o/s),r=Math.max(a,r/s),{points:[B(n),B(i),B(o),B(r)],zoom:s,orientation:this.data.orientation}}var N={type:"canvas",format:"png",quality:1},z=["jpeg","webp","png"];if(window.jQuery){var X=window.jQuery;X.fn.croppie=function(t){if("string"==typeof t){var e=Array.prototype.slice.call(arguments,1),n=X(this).data("croppie");return"get"===t?n.get():"result"===t?n.result.apply(n,e):"bind"===t?n.bind.apply(n,e):this.each(function(){var n=X(this).data("croppie");if(n){var i=n[t];if(!X.isFunction(i))throw"Croppie "+t+" method not found";i.apply(n,e),"destroy"===t&&X(this).removeData("croppie")}})}return this.each(function(){var e=new Z(this,t);e.$=X,X(this).data("croppie",e)})}}function Z(t,e){if(t.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=t,this.options=u(h(Z.defaults),e),"img"===this.element.tagName.toLowerCase()){var o=this.element;d(o,"cr-original-image"),f(o,{"aria-hidden":"true",alt:""});var r=document.createElement("div");this.element.parentNode.appendChild(r),r.appendChild(o),this.element=r,this.options.url=this.options.url||o.src}if((function(){var t,e,o,r,s,a=this.options.viewport.type?"cr-vp-"+this.options.viewport.type:null;this.options.useCanvas=this.options.enableOrientation||C.call(this),this.data={},this.elements={},t=this.elements.boundary=document.createElement("div"),e=this.elements.viewport=document.createElement("div"),this.elements.img=document.createElement("img"),o=this.elements.overlay=document.createElement("div"),this.options.useCanvas?(this.elements.canvas=document.createElement("canvas"),this.elements.preview=this.elements.canvas):this.elements.preview=this.elements.img,d(t,"cr-boundary"),t.setAttribute("aria-dropeffect","none"),s=this.options.boundary.height,p(t,{width:(r=this.options.boundary.width)+(isNaN(r)?"":"px"),height:s+(isNaN(s)?"":"px")}),d(e,"cr-viewport"),a&&d(e,a),p(e,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),e.setAttribute("tabindex",0),d(this.elements.preview,"cr-image"),f(this.elements.preview,{alt:"preview","aria-grabbed":"false"}),d(o,"cr-overlay"),this.element.appendChild(t),t.appendChild(this.elements.preview),t.appendChild(e),t.appendChild(o),d(this.element,"croppie-container"),this.options.customClass&&d(this.element,this.options.customClass),(function(){var t,e,o,r,s,a=this,l=!1;function u(t,e){var n=a.elements.preview.getBoundingClientRect(),i=s.y+e,o=s.x+t;a.options.enforceBoundary?(r.top>n.top+e&&r.bottom<n.bottom+e&&(s.y=i),r.left>n.left+t&&r.right<n.right+t&&(s.x=o)):(s.y=i,s.x=o)}function h(t){a.elements.preview.setAttribute("aria-grabbed",t),a.elements.boundary.setAttribute("aria-dropeffect",t?"move":"none")}function d(n){if((void 0===n.button||0===n.button)&&(n.preventDefault(),!l)){if(t=n.pageX,e=n.pageY,n.touches){var o=n.touches[0];t=o.pageX,e=o.pageY}h(l=!0),s=w.parse(a.elements.preview),window.addEventListener("mousemove",f),window.addEventListener("touchmove",f),window.addEventListener("mouseup",m),window.addEventListener("touchend",m),document.body.style[i]="none",r=a.elements.viewport.getBoundingClientRect()}}function f(i){i.preventDefault();var r=i.pageX,l=i.pageY;if(i.touches){var h=i.touches[0];r=h.pageX,l=h.pageY}var d=r-t,f=l-e,m={};if("touchmove"===i.type&&i.touches.length>1){var g=i.touches[0],v=i.touches[1],w=Math.sqrt((g.pageX-v.pageX)*(g.pageX-v.pageX)+(g.pageY-v.pageY)*(g.pageY-v.pageY));return o||(o=w/a._currentZoom),E.call(a,w/o),void c(a.elements.zoomer)}u(d,f),m[n]=s.toString(),p(a.elements.preview,m),k.call(a),e=l,t=r}function m(){h(l=!1),window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",m),window.removeEventListener("touchend",m),document.body.style[i]="",R.call(a),P.call(a),o=0}a.elements.overlay.addEventListener("mousedown",d),a.elements.viewport.addEventListener("keydown",function(t){var e;if(!t.shiftKey||38!==t.keyCode&&40!==t.keyCode){if(a.options.enableKeyMovement&&t.keyCode>=37&&t.keyCode<=40){t.preventDefault();var l=function(e){switch(t.keyCode){case 37:return[1,0];case 38:return[0,1];case 39:return[-1,0];case 40:return[0,-1]}}();s=w.parse(a.elements.preview),document.body.style[i]="none",r=a.elements.viewport.getBoundingClientRect(),function(t){var e={};u(t[0],t[1]),e[n]=s.toString(),p(a.elements.preview,e),k.call(a),document.body.style[i]="",R.call(a),P.call(a),o=0}(l)}}else e=38===t.keyCode?parseFloat(a.elements.zoomer.value,10)+parseFloat(a.elements.zoomer.step,10):parseFloat(a.elements.zoomer.value,10)-parseFloat(a.elements.zoomer.step,10),a.setZoom(e)}),a.elements.overlay.addEventListener("touchstart",d)}).call(this),this.options.enableZoom&&(function(){var t=this,e=t.elements.zoomerWrap=document.createElement("div"),n=t.elements.zoomer=document.createElement("input");function i(){L.call(t,{value:parseFloat(n.value),origin:new y(t.elements.preview),viewportRect:t.elements.viewport.getBoundingClientRect(),transform:w.parse(t.elements.preview)})}function o(e){var n;if("ctrl"===t.options.mouseWheelZoom&&!0!==e.ctrlKey)return 0;n=t._currentZoom+(e.wheelDelta?e.wheelDelta/1200:e.deltaY?e.deltaY/1060:e.detail?e.detail/-60:0)*t._currentZoom,e.preventDefault(),E.call(t,n),i.call(t)}d(e,"cr-slider-wrap"),d(n,"cr-slider"),n.type="range",n.step="0.0001",n.value=1,n.style.display=t.options.showZoomer?"":"none",n.setAttribute("aria-label","zoom"),t.element.appendChild(e),e.appendChild(n),t._currentZoom=1,t.elements.zoomer.addEventListener("input",i),t.elements.zoomer.addEventListener("change",i),t.options.mouseWheelZoom&&(t.elements.boundary.addEventListener("mousewheel",o),t.elements.boundary.addEventListener("DOMMouseScroll",o))}).call(this),this.options.enableResize&&(function(){var t,e,n,o,r,s,a,l=this,u=document.createElement("div"),h=!1,c=50;function f(s){if((void 0===s.button||0===s.button)&&(s.preventDefault(),!h)){var a=l.elements.overlay.getBoundingClientRect();if(h=!0,e=s.pageX,n=s.pageY,t=-1!==s.currentTarget.className.indexOf("vertical")?"v":"h",o=a.width,r=a.height,s.touches){var u=s.touches[0];e=u.pageX,n=u.pageY}window.addEventListener("mousemove",m),window.addEventListener("touchmove",m),window.addEventListener("mouseup",g),window.addEventListener("touchend",g),document.body.style[i]="none"}}function m(i){var s=i.pageX,a=i.pageY;if(i.preventDefault(),i.touches){var h=i.touches[0];s=h.pageX,a=h.pageY}var d=s-e,f=a-n,m=l.options.viewport.height+f,g=l.options.viewport.width+d;"v"===t&&m>=c&&m<=r?(p(u,{height:m+"px"}),l.options.boundary.height+=f,p(l.elements.boundary,{height:l.options.boundary.height+"px"}),l.options.viewport.height+=f,p(l.elements.viewport,{height:l.options.viewport.height+"px"})):"h"===t&&g>=c&&g<=o&&(p(u,{width:g+"px"}),l.options.boundary.width+=d,p(l.elements.boundary,{width:l.options.boundary.width+"px"}),l.options.viewport.width+=d,p(l.elements.viewport,{width:l.options.viewport.width+"px"})),k.call(l),j.call(l),R.call(l),P.call(l),n=a,e=s}function g(){h=!1,window.removeEventListener("mousemove",m),window.removeEventListener("touchmove",m),window.removeEventListener("mouseup",g),window.removeEventListener("touchend",g),document.body.style[i]=""}d(u,"cr-resizer"),p(u,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(d(s=document.createElement("div"),"cr-resizer-vertical"),u.appendChild(s)),this.options.resizeControls.width&&(d(a=document.createElement("div"),"cr-resizer-horisontal"),u.appendChild(a)),s&&(s.addEventListener("mousedown",f),s.addEventListener("touchstart",f)),a&&(a.addEventListener("mousedown",f),a.addEventListener("touchstart",f)),this.elements.boundary.appendChild(u)}).call(this)}).call(this),this.options.url){var s={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,q.call(this,s)}}Z.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},Z.globals={translate:"translate3d"},u(Z.prototype,{bind:function(t,e){return q.call(this,t,e)},get:function(){var t=F.call(this),e=t.points;return this.options.relative&&(e[0]/=this.elements.img.naturalWidth/100,e[1]/=this.elements.img.naturalHeight/100,e[2]/=this.elements.img.naturalWidth/100,e[3]/=this.elements.img.naturalHeight/100),t},result:function(t){return(function(t){var e=this,n=F.call(e),i=u(h(N),h(t)),o="string"==typeof t?t:i.type||"base64",r=i.size||"viewport",s=i.format,a=i.quality,l=i.backgroundColor,c="boolean"==typeof i.circle?i.circle:"circle"===e.options.viewport.type,f=e.elements.viewport.getBoundingClientRect(),m=f.width/f.height;return"viewport"===r?(n.outputWidth=f.width,n.outputHeight=f.height):"object"==typeof r&&(r.width&&r.height?(n.outputWidth=r.width,n.outputHeight=r.height):r.width?(n.outputWidth=r.width,n.outputHeight=r.width/m):r.height&&(n.outputWidth=r.height*m,n.outputHeight=r.height)),z.indexOf(s)>-1&&(n.format="image/"+s,n.quality=a),n.circle=c,n.url=e.data.url,n.backgroundColor=l,new Promise(function(t,i){switch(o.toLowerCase()){case"rawcanvas":t(A.call(e,n));break;case"canvas":case"base64":t((function(t){return A.call(this,t).toDataURL(t.format,t.quality)}).call(e,n));break;case"blob":(function(t){var e=this;return new Promise(function(n,i){A.call(e,t).toBlob(function(t){n(t)},t.format,t.quality)})}).call(e,n).then(t);break;default:t((function(t){var e=t.points,n=document.createElement("div"),i=document.createElement("img"),o=e[2]-e[0],r=e[3]-e[1];return d(n,"croppie-result"),n.appendChild(i),p(i,{left:-1*e[0]+"px",top:-1*e[1]+"px"}),i.src=t.url,p(n,{width:o+"px",height:r+"px"}),n}).call(e,n))}})}).call(this,t)},refresh:function(){return(function(){T.call(this)}).call(this)},setZoom:function(t){E.call(this,t),c(this.elements.zoomer)},rotate:function(t){(function(t){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var e,n,i,o,r=this.elements.canvas;this.data.orientation=(n=t,o=(i=s.indexOf(e=this.data.orientation)>-1?s:a).indexOf(e),i[(i.length+o+n/90%i.length%i.length)%i.length]),x(r,this.elements.img,this.data.orientation),j.call(this),L.call(this),copy=null}).call(this,t)},destroy:function(){return(function(){var t,e;this.element.removeChild(this.elements.boundary),e="croppie-container",(t=this.element).classList?t.classList.remove(e):t.className=t.className.replace(e,""),this.options.enableZoom&&this.element.removeChild(this.elements.zoomerWrap),delete this.elements}).call(this)}}),t.Croppie=window.Croppie=Z});